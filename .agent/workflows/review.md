---
description: получение и обработка комментариев из GitHub PR
---

Этот воркфлоу помогает быстро собрать все открытые замечания из пулл-реквеста и превратить их в локальный чеклист.

## Шаг 1: Подготовка

Убедитесь, что в файле `.env` указаны необходимые данные:

- `GITHUB_TOKEN`: токен с правами `pull_requests:write` (нужен для закрытия обсуждений).
- `PR_NUMBER` — номер вашего PR (например, `1`).

> ⚠️ **Безопасность:** `.env` не должен попадать в git (проверьте `.gitignore`). Используйте fine-grained PAT с минимальными правами.

## Шаг 2: Получение комментариев

Запустите команду для сбора неразрешенных обсуждений:

```bash
make review-fetch
```

## Шаг 3: Проверка актуальности

**Важно:** Комментарии могут быть помечены как "неразрешённые" на GitHub, но уже исправлены в коде. Перед анализом:

1. Для каждого замечания проверь соответствующий файл в текущей кодовой базе.
2. Если проблема уже исправлена — сразу отметь `[x] нет` с пометкой "уже исправлено".
3. Если проблема актуальна — переходи к заполнению полей.

## Шаг 4: Анализ и заполнение полей

Для **каждого актуального** замечания в `docs/REVIEW.md` заполни следующие поля:

1. **Перевод** — переведи англоязычный Prompt на русский язык, кратко и понятно.
2. **Оценка сложности (1-10)** — оцени трудозатраты:
   - 1-3: тривиальное исправление (опечатка, добавление атрибута)
   - 4-6: требует понимания контекста и небольших изменений
   - 7-10: сложная логика, риск регрессий, требует тестирования.
3. **Стоит ли исправлять** — отметь одну из опций:
   - `[x] да` — исправление полезно и безопасно
   - `[x] нет` — избыточно, спорно или не соответствует проекту
   - `[x] обсудить` — требует обсуждения с командой или ревьюером

После заполнения всех полей покажи результат пользователю для подтверждения.

## Шаг 5: Исправление

После одобрения пользователя:

1. Исправь отмеченные как `[x] да` замечания.
2. После исправления каждого пункта отмечай основной чекбокс как выполненный: `- [x]`.
3. **Обязательно проверь** перед закрытием:
   ```bash
   make dev && make test
   ```

## Шаг 6: Закрытие тредов на GitHub

**Строго после одобрения пользователем** закрой выполненные треды.

1. Запусти скрипт (он встанет на паузу):
   ```bash
   make review-resolve
   ```
2. Скрипт покажет количество тредов и спросит подтверждение.
3. Ответь `y`, только если уверен.

Скрипт найдёт все отмеченные как `[x]` задачи в `docs/REVIEW.md` и закроет соответствующие треды на GitHub через API.

## Результат

Вы получаете чистый список дел прямо в IDE, что позволяет исправлять замечания последовательно, не переключаясь на браузер. После завершения треды автоматически закрываются на GitHub.