# Yii2 Book Catalog System

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–æ–º –∫–Ω–∏–≥ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –∏ Clean Architecture –Ω–∞ –±–∞–∑–µ Yii2 Basic.

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **Core:** PHP 8.4 (Strict Types, Readonly classes, Constructor Promotion).
*   **Framework:** Yii2 Basic.
*   **Database:** MySQL 8.0.
*   **Async:** `yii2-queue` (DB driver) ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—è–∂–µ–ª—ã—Ö –∑–∞–¥–∞—á.
*   **Env:** Docker / Docker Compose.

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **Thin Controller / Fat Service** –∏ **Code by Contract**.

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1.  **Service Layer (`app/services`)**
    *   –ò–∑–æ–ª–∏—Ä—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ—Ç HTTP-—Å–ª–æ—è.
    *   –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –ë–î.
    *   –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ç—Ä–∏–≥–≥–µ—Ä—ã —Å–æ–±—ã—Ç–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, push –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥—å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–∏–≥–∏).

2.  **DTO / Forms (`app/models/forms`)**
    *   –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ ActiveRecord –º–æ–¥–µ–ª–µ–π.
    *   –ü–æ–∑–≤–æ–ª—è—é—Ç —á–∏—Å—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ –∏ —Å–ª–æ–∂–Ω—ã–µ —Å–≤—è–∑–∏ (Many-to-Many) –¥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î.

3.  **Contracts (`app/interfaces`)**
    *   `SmsSenderInterface` ‚Äî –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ (SMS Pilot / Mock) —á–µ—Ä–µ–∑ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–∫–æ–¥–∞.
    *   `FileStorageInterface` ‚Äî –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤.

4.  **Async Jobs (`app/jobs`)**
    *   –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Ñ–æ–Ω.
    *   –í–æ—Ä–∫–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ `queue`.

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `make`.

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥–∏–Ω–≥ –±–∞–∑—ã:

```bash
make init
```

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:8000](http://localhost:8000)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|
| `make up` | –ü–æ–¥–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã |
| `make down` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã |
| `make shell` | –ó–∞–π—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ PHP |
| `make sms-logs` | –ß–∏—Ç–∞—Ç—å –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS (tail -f) |
| `make queue-info` | –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á |
| `make seed` | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–µ–∂–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ |

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ —Ñ–∞–π–ª `.env`.

*   **–ë–î:** `DB_HOST`, `DB_NAME`, `DB_USER` –∏ —Ç.–¥.
*   **SMS:** `SMS_API_KEY`.
    *   –£–∫–∞–∂–∏—Ç–µ `MOCK_KEY` –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ (–ø–∏—à–µ—Ç—Å—è –≤ –ª–æ–≥).
    *   –£–∫–∞–∂–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π API Key SMS Pilot –¥–ª—è –±–æ–µ–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–≤–∞–∂–Ω–æ–µ)

```
app/
‚îú‚îÄ‚îÄ commands/          # –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (Seed, etc)
‚îú‚îÄ‚îÄ controllers/       # HTTP –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (—Ç–æ–ª—å–∫–æ —Ä–æ—É—Ç–∏–Ω–≥ –∏ –≤—ã–∑–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤)
‚îú‚îÄ‚îÄ interfaces/        # –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã (SmsSender, FileStorage)
‚îú‚îÄ‚îÄ jobs/              # –ó–∞–¥–∞—á–∏ –¥–ª—è –æ—á–µ—Ä–µ–¥–∏
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ forms/         # DTO –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º
‚îÇ   ‚îî‚îÄ‚îÄ ...            # ActiveRecord —Å—É—â–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ sms/           # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ storage/       # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
‚îî‚îÄ‚îÄ views/             # –®–∞–±–ª–æ–Ω—ã
```